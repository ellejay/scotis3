<!DOCTYPE html>
<html>
<meta charset="utf-8">
<head>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<link href='http://fonts.googleapis.com/css?family=Raleway:400,700' rel='stylesheet' type='text/css'>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>
<script src="datamaps.none.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.1/jquery.min.js"></script>
<script src="http://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>
<script type ="text/javascript" src="popup.js"></script>
<script type="text/javascript" src="aster.js"></script>
<script>
var data; 
var names;

d3.json("areas.json", function(json) {
    data = json;
    names = d3.keys(data[0]);
    pieData = names[1];
    for (var i = 0; i < data.length; i++) {           
        console.log(data[i]["Local Authority Name"]) ; 
        console.log(data[i][names[0]]);
};
});

</script>


<script>
//var order = ['fill1', 'fill2', 'fill3', 'fill4', 'fill5', 'fill6', 'fill7', 'fill8', 'fill9', 'fill10', 'fill11', 'fill12', 'fill13', 'fill14', 'fill1', 'fill1', 'fill1', 'fill18', 'fill19', 'fill20', 'fill21', 'fill22', 'fill23', 'fill24', 'fill25', 'fill26', 'fill27', 'fill28', 'fill29', 'fill30', 'fill31', 'fill32'];
var order = new Array(32);
  for (var i = 0; i < 32; i++) {
    order[i] = new Array(32);
  }

d3.json("areas.json", function(json) {
		data = json;
		names = d3.keys(data[0]);
		for (var i = 0; i < 32; i++) {
			for (var j = 0; j < data.length; j++) {           
				order[i][j] = "fill" + data[j][names[i]];
			};
		};
});

function recolour(id) {
		
    map.updateChoropleth({
	
	    'abd': { fillKey: order[id][0] }, 'abs': { fillKey: order[id][1] }, 'ang': { fillKey: order[id][2] },
		'arg': { fillKey: order[id][3] }, 'cla': { fillKey: order[id][4] }, 'com': { fillKey: order[id][5] },
		'dum': { fillKey: order[id][6] }, 'dun': { fillKey: order[id][7] }, 'eay': { fillKey: order[id][8] },
		'edu': { fillKey: order[id][9] }, 'elt': { fillKey: order[id][10] }, 'erf': { fillKey: order[id][11] },
		'edn': { fillKey: order[id][12] }, 'flk': { fillKey: order[id][13] }, 'fif': { fillKey: order[id][14] },
		'gla': { fillKey: order[id][15] }, 'hgh': { fillKey: order[id][16] }, 'inv': { fillKey: order[id][17] },
		'mid': { fillKey: order[id][18]}, 'mry': { fillKey: order[id][19] }, 'nay': { fillKey: order[id][20] },
		'nln': { fillKey: order[id][21] }, 'ork': { fillKey: order[id][22] }, 'per': { fillKey: order[id][23] },
		'ren': { fillKey: order[id][24] }, 'brd': { fillKey: order[id][25] }, 'sht': { fillKey: order[id][26] },
		'say': { fillKey: order[id][27] }, 'sln': { fillKey: order[id][28] }, 'str': { fillKey: order[id][29] },
		'wdu': { fillKey: order[id][30] }, 'wlt': { fillKey: order[id][31] },
	
	});
	
}

</script>

<a href="#?w=600" rel="box1" class="poplight" id="fadebox" style="display: none;"></a>

<table><tr><td>
<div id="container" style="position: relative; width: 500px; height: 800px;"></div>
</td><td valign="top">
<form name="form">
	<table cellspacing="2">
		<tr>
            <!-- <td><input type="radio" name="group1" value=0 > 
            //	<label style="font-size: 12px;" for=0>Local Authority Name</label></td> -->
            <td><input type="radio" name="group1" value=1 onclick="recolour(this.value)" > 
            	<label style="font-size: 12px;" for=1>Total Population</label> </td>
            <td><input type="radio" name="group1" value=2 onclick="recolour(this.value)"> 
            	<label style="font-size: 12px;" for=2>Average Best-fit Working Age Population</label></td>
            <td><input type="radio" name="group1" value=3 onclick="recolour(this.value)"> 
            	<label style="font-size: 12px;" for=3>Overall Average SIMD 2012 Score</label></td>
            <td><input type="radio" name="group1" value=4 onclick="recolour(this.value)"> 
            	<label style="font-size: 12px;" for=4>Overall Average SIMD 2012 Rank</label></td> 
            <td><input type="radio" name="group1" value=5 onclick="recolour(this.value)"> 
            	<label style="font-size: 12px;" for=5>Education,Skills and Training score</label></td>
            <td><input type="radio" name="group1" value=6 onclick="recolour(this.value)"> 
                <label style="font-size: 12px;" for=6>Education, Skills and Training rank</label></td>
        </tr>
        <tr>    
            <td><input type="radio" name="group1" value=7 onclick="recolour(this.value)"> 
            	<label style="font-size: 12px;" for=7>Working age people with no qualifications</label></td> 
            <td><input type="radio" name="group1" value=8 onclick="recolour(this.value)"> 
            	<label style="font-size: 12px;" for=8>People aged 16-19 unemployed/uneducated</label></td>
            <td><input type="radio" name="group1" value=9 onclick="recolour(this.value)"> 
            	<label style="font-size: 12px;" for=9>Avg People aged 17- 21 entering Uni/College</label></td>
            <td><input type="radio" name="group1" value=10 onclick="recolour(this.value)"> 
                <label style="font-size: 12px;" for=10>Average pupil Performance on SQA at Stage 4</label> </td>
            <td><input type="radio" name="group1" value=11 onclick="recolour(this.value)"> 
                <label style="font-size: 12px;" for=11>Average School Pupil Absences</label></td>
            <td><input type="radio" name="group1" value=12 onclick="recolour(this.value)"> 
                <label style="font-size: 12px;" for=12>Housing domain rank </label></td>
        </tr>
        <tr>
            <td><input type="radio" name="group1" value=13 onclick="recolour(this.value)"> 
            	<label style="font-size: 12px;" for=13>Average housing domain score</label></td> 
            <td><input type="radio" name="group1" value=14 onclick="recolour(this.value)"> 
            	<label style="font-size: 12px;" for=14>Household Population </label></td>
            <td><input type="radio" name="group1" value=15 onclick="recolour(this.value)"> 
            	<label style="font-size: 12px;" for=15> Avg % of people in households without central heating</label></td>
            <td><input type="radio" name="group1" value=16 onclick="recolour(this.value)">  
            	<label style="font-size: 12px;" for=16>Avg % of people in overcrowded homes </label></td>
            <td><input type="radio" name="group1" value=18 onclick="recolour(this.value)">  
                <label style="font-size: 12px;" for=18> SIMD Crime 2012 rank</label></td>
            <td><input type="radio" name="group1" value=19 onclick="recolour(this.value)">  
                <label style="font-size: 12px;" for=19> SIMD Crime 2012 count</label></td>
           <!-- <td><input type="radio" name="group1" value=17 >  
            	<label style="font-size: 12px;" for=17>Police Force Area</label></td> -->
        </tr>
        <tr>
            <td><input type="radio" name="group1" value=20 onclick="recolour(this.value)">  
            	<label style="font-size: 12px;" for=20>SIMD Average Crimes per 10,000 tot.pop.</label></td>
            <td><input type="radio" name="group1" value=21 onclick="recolour(this.value)">  
            	<label style="font-size: 12px;" for=21>Electorate Number</label></td>
            <td><input type="radio" name="group1" value=22 onclick="recolour(this.value)">  
            	<label style="font-size: 12px;" for=22>Number of Votes </label></td>
            <td><input type="radio" name="group1" value=23 onclick="recolour(this.value)">  
            	<label style="font-size: 12px;" for=23>Yes Votes</label></td>
            <td><input type="radio" name="group1" value=24 onclick="recolour(this.value)">  
                <label style="font-size: 12px;" for=24> No Votes</label></td>
            <td><input type="radio" name="group1" value=25 onclick="recolour(this.value)">  
                <label style="font-size: 12px;" for=25>Rejected Papers </label></td>
        </tr>
        <tr>
            <td><input type="radio" name="group1" value=26 onclick="recolour(this.value)">  
            	<label style="font-size: 12px;" for=26>Estimated population (2013)</label></td>
            <td><input type="radio" name="group1" value=27 onclick="recolour(this.value)">  
            	<label style="font-size: 12px;" for=27>Estimated Males (2013)</label></td>
            <td><input type="radio" name="group1" value=28 onclick="recolour(this.value)">  
            	<label style="font-size: 12px;" for=28>Estimated Females (2013)</label></td>
            <td><input type="radio" name="group1" value=29 onclick="recolour(this.value)">  
            	<label style="font-size: 12px;" for=29>"Area (square km)</label></td>
        	<td><input type="radio" name="group1" value=30 onclick="recolour(this.value)">  
            	<label style="font-size: 12px;" for=30>Population density</label></td>
            <td><input type="radio" name="group1" value=31 onclick="recolour(this.value)">  
            	<label style="font-size: 12px;" for=31>Council expenditure per capita (Â£)</label></td>
        </tr>
</form>

</td></tr>

<tr>
<td></td>
<td><div id="aesterplot"></div>
</td>
</tr></table>



<script>
    var map = new Datamap({
      element: document.getElementById('container'),
      geographyConfig: {
        dataUrl: 'scotland.json',
		borderColor: '#4d4d4d',
		highlightFillColor: '#EAED98',
		highlightBorderColor: '#4d4d4d',
		highlightBorderWidth: 1
      },
      scope: 'councils',
	  
	  fills: {
          defaultFill: '#000',
          fill1: '#a83b42',  fill2: '#a63c47',   fill3: '#a43d4d',
		  fill4: '#a23f52',  fill5: '#a04058',   fill6: '#9e425d',
		  fill7: '#9C4363',   fill8: '#9A4569',	  fill9: '#98466E',
		  fill10: '#964874',     fill11: '#944979',    fill12: '#924A7F',
		  fill13: '#904C84',     fill14: '#8E4D8A', 	  fill15: '#8C4F90',
		  fill16: '#8A5095',	  fill17: '#88529B',	  fill18: '#8653A0',
		  fill19: '#8455A6',	  fill20: '#8256AC',	  fill21: '#8058B1',
		  fill22: '#7E59B7',	  fill23: '#7C5ABC',	  fill24: '#7A5CC2',
		  fill25: '#785DC7',	  fill26: '#765FCD',	  fill27: '#7460D3',
		  fill28: '#7262D8',	  fill29: '#7063DE',	  fill30: '#6E65E3', 
		  fill31: '#6C66E9',	  fill32: '#6A68EF',
      },
	  
	  data: {
		'abd': { fillKey: 'fill1' }, 'abs': { fillKey: 'fill2' }, 'ang': { fillKey: 'fill3' },
		'arg': { fillKey: 'fill4' }, 'cla': { fillKey: 'fill5' }, 'com': { fillKey: 'fill6' },
		'dum': { fillKey: 'fill7' }, 'dun': { fillKey: 'fill8' }, 'eay': { fillKey: 'fill9' },
		'edu': { fillKey: 'fill10' }, 'elt': { fillKey: 'fill11' }, 'erf': { fillKey: 'fill12' },
		'edn': { fillKey: 'fill13' }, 'flk': { fillKey: 'fill14' }, 'fif': { fillKey: 'fill15' },
		'gla': { fillKey: 'fill16' }, 'hgh': { fillKey: 'fill17' }, 'inv': { fillKey: 'fill18' },
		'mid': { fillKey: 'fill19' }, 'mry': { fillKey: 'fill20' }, 'nay': { fillKey: 'fill21' },
		'nln': { fillKey: 'fill22' }, 'ork': { fillKey: 'fill23' }, 'per': { fillKey: 'fill24' },
		'ren': { fillKey: 'fill25' }, 'brd': { fillKey: 'fill26' }, 'sht': { fillKey: 'fill27' },
		'say': { fillKey: 'fill28' }, 'sln': { fillKey: 'fill29' }, 'str': { fillKey: 'fill30' },
		'wdu': { fillKey: 'fill31' }, 'wlt': { fillKey: 'fill32' },
	  },
	  
	  done: function(datamap) {
            datamap.svg.selectAll('.datamaps-subunit').on('click', function(geography) {
            	popitup(geography.properties.name);
				//var box = document.getElementById('box1')
				//box.innerHTML = "<div class='popup_title'>" + geography.properties.name + "</div> "
				//document.getElementById('fadebox').click();
            });
      },
	  
      setProjection: function(element, options) {
         var projection = d3.geo.equirectangular()
           .center([5, 5])
           .rotate([4.4, 0])
           .scale(900)
           .translate([element.offsetWidth / 2, element.offsetHeight / 2]);

        var path = d3.geo.path()
               .projection(projection);
                                               
        return {path: path, projection: projection};
        }
    });
	function popitup(name) {
		newwindow=window.open('scotlandBarChart.html',name,'height=500,width=700');
		if (window.focus) {newwindow.focus()}
			return false;
	}
</script>
<div id="box1" class="popup_block">

</div>	

</body>
<div id="box2"></div>
</html>